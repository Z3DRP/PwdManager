<!-- eventually pull html out into manage card but need to pass in accounts -->
<!-- TODO this will need some changing needs converted to Flask WTF forms and to find out how to specify value of flask form field -->

{% extends 'base.html' %}
{% block content %}

<!-- example to show displaying dictionary data -->
<!-- NOTE: when user clicks edit button, redirect to page with form, values autofilled. when user makes changes, must click save to save changes, then redirects to this display page. -->

<h1>Dictionary Contents:</h1>
<ul>
{% for key, value in test_data.items() %}
    <div>
        <li>{{ key }}: {{ value }}</li><button type="edit" class="jaz-button" onclick="handleEdit">Edit</button>
    </div>
{% endfor %}
</ul>

<!-- alternate example -->

<h1>Dictionary Contents:</h1>
<ul>
    {% for key, value in test_data.items() %}
        <div>
            <li>
                {{ key }}: <span id="{{ key }}-value">{{ value }}</span>
                <button id="{{ key }}-edit" onclick="editValue('{{ key }}')">Edit</button>
                <input id="{{ key }}-input" type="text" style="display: none;">
                <button id="{{ key }}-save" onclick="saveValue('{{ key }}')" style="display: none;">Save</button>"
            </li>
        </div>
    {% endfor %}
</ul>

<script>
    function editValue(key) {
        document.getElementByID(`${key}-value`).style.display = 'none';
        document.getElementById(`${key}-edit`).style.display = 'none';
        document.getElementById(`${key}-input`).style.display = 'inline';
        document.getElementById(`${key}-save`).style.display = 'inline';
        document.getElementById(`${key}-input`).value = document.getElementById(`${key}-value`).innerText;
    }

    function saveValue(key) {
            const newValue = documetn.getElementByID(`${key}-input`).value;
            document.getElementById(`${key}-value`).innerText = newValue;
            document.getElementById(`${key}-value`).style.display = 'inline';
            document.getElementById(`${key}-edit`).style.display = 'inline';
            document.getElementById(`${key}-input`).style.display = 'none';
            document.getElementById(`${key}-save`).style.display = 'none';

            // Update the dictionary data on the server-side using fetch (pulled this from online, looks like it should work, but not too familiar with javascript)
            fetch('/update', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ key: key, value: newValue})
            })
            .then(response => response.json())
            .then(data => {
                console.log('Server response:', data);
            })
            .catch(error => {
                console.error('Error updating value:', error);
            })
        }
</script>



<!-- if might have to change-->
{% for account in accounts %}

    <div class="flip-card" data-id=account.account_id>
        <div class="flip-card-inner">
            <div class="flip-card-front">
                
                <p class="title">{{ account.name }}</p>
                
                <button type="submit" class="jaz-button" onclick="handleDelete">Delete</button>
            </div>
            
            <div class="flip-card-back">
                
                <form method="POST">
                    
                    <div class="form-group">
                        {{ form.account.name }}
                        {{ form.username(value=account.username) }}
                    </div>
                    
                    <div class="form-group">
                        {{ form.account.email }}
                        {{ form.email(value=account.email) }}
                    </div>
                    
                    <div class="form-group">
                        {{ form.account.password }}
                        {{ form.password(value=account.password) }}
                    </div>
                    
                    {{ form.submit }}
                
                </form>
            </div>
        </div>
    </div>

{% else %}

<!-- if accounts does not have anything in it -->
<div class="flip-card" data-id="0">
    <div class="fli-card-inner">
        <div clas="flip-card-front">
            
            <p class="title">New Account</p>
            
            <button type="submit" class="jaz-button" onclick="handleDelete">Delete</button>
        </div>
        
        <div class="flip-card-back">
            <form method="POST">
                {{ form.hidden_tag() }}
                
                <div class="form-group">
                    {{ form.account_name.label }}
                    {{ form.account_name() }}
                </div>
                
                <div class="form-group">
                    {{ form.username.label }}
                    {{ form.username() }}
                </div>
                
                <div class="form-group">
                    {{ form.email.label }}
                    {{ form.email() }}
                </div>
                
                <div class="form-group">
                    {{ form.pwd.label }}
                    {{ form.pwd() }}
                </div>
                
                <div class="form-group">
                    {{ form.create(class="jaz-button") }}
                
                </div>
            
            </form>
        </div>
    </div>
</div>

{% endfor %}

<button class="btn btn-primary mt-5 mb-5" onclick="handleAddAccount">Add Account</button>

{% endblock %}